\section{Esami}

\subsection{24/07/2025}

\subsubsection*{Esercizio 1}

Si consideri la matrice $A \in \mathbb{R}^{n \times n}$ ed il vettore $\mathbf{b} \in \mathbb{R}^{n}$ tali che:
\begin{equation*}
    A = \begin{bmatrix}
        2 & -1 & 0 & 0 & \cdots & 0 \\
        -1 & 2 & -1 & 0 & \cdots & 0 \\
        0 & -1 & \ddots & \ddots & \ddots & \vdots \\
        0 & 0 & \ddots & \ddots & \ddots & 0 \\
        \vdots & \vdots & \vdots & -1 & 2 & -1 \\
        0 & 0 & \cdots & 0 & -1 & 2 \\
    \end{bmatrix}
    \hspace{3em}
    \mathbf{b} = \begin{bmatrix}
        -1 \\
        -1 \\
        -1 \\
        \vdots \\
        -1 \\
        -1 \\
    \end{bmatrix}
\end{equation*}
\begin{enumerate}
    \item Utilizzando gli opportuni comandi Matlab, si costruiscano la matrice $A$ ed il vettore $\mathbf{b}$ per $n = 7$. Utilizzando il comando \textbackslash si risolva il sistema lineare $A\mathbf{x} = \mathbf{b}$. Riportare $\mathbf{x}$ e tutti i comandi Matlab usati.
    
    \textcolor{Green3}{\textbf{\emph{Soluzione}}}
    \begin{lstlisting}[language=MATLAB]
% dimensione di n
n = 7;
% creiamo un vettore di 1 e aggiungiamo 1
A = diag(ones(n,1)+1) +         % diag. principale
    diag(ones(n-1,1)-2, 1) +    % diag. sopra principale
    diag(ones(n-1,1)-2, -1);    % diag. sotto principale
% creiamo vettore b
b = -ones(n,1);
% calcola soluzione di x
x = A\b;\end{lstlisting}
Il vettore \texttt{x} produce il seguente risultato:
\begin{equation*}
    \mathbf{x} = \begin{bmatrix}
        -3.5 \\
        -6 \\
        -7.5 \\
        -8 \\
        -7.5 \\
        -6 \\
        -3.5
    \end{bmatrix}
\end{equation*}

    \item Elencare e discutere:
    \begin{enumerate}
        \item Le condizioni sufficienti per la convergenza del metodo di Gauss-Seidel.
        \item Le condizioni necessarie e sufficienti per la convergenza del metodo di Gauss-Seidel.
    \end{enumerate}
    Data $B_{GS}$ la matrice di iterazione di Gauss-Seidel, dimostrare che\break $\left\| B_{GS} \right\| < 1$ implica la convergenza.

    \textcolor{Green3}{\textbf{\emph{Soluzione.}}} Le condizioni sufficienti per la convergenza del metodo di Gauss-Seidel sono 3:
    \begin{itemize}
        \item La matrice $A$ deve essere a \textbf{dominanza diagonale stretta per righe}:
        \begin{equation*}
            \left|a_{ii}\right| > \displaystyle\sum_{j \ne i} \left|a_{ij}\right| \hspace{1em} \forall i
        \end{equation*}
        \item La matrice $A$ deve essere \textbf{simmetrica definita positiva (SPD)}:
        \begin{equation*}
            \mathbf{x}^{T} A \mathbf{x} > 0 \hspace{1em} \forall \mathbf{x} \ne 0
        \end{equation*}
        \item La matrice $A$ deve essere una \textbf{Matrice di classe M (M-Matrice) non singolare}. Ovvero una matrice con diagonale positiva e elementi extradiagonali (non sulla diagonale) non positivi.
    \end{itemize}
    L'unica condizione necessarie e sufficiente per la convergenza è quando il raggio spettrale della matrice di iterazione $B_{GS}$ è minore di uno:
    \begin{equation*}
        \text{convergenza} \iff \rho(B_{GS}) < 1
    \end{equation*}
    \begin{proof}[Dimostrazione ($\left\| B_{GS} \right\| < 1$ implica la convergenza)]
        Il metodo di Gauss-Seidel si scrive
        \begin{equation*}
            x^{(k+1)} = B_{GS}x^{(k)} + c
        \end{equation*}
        Definendo l'errore $e^{(k)} = x^{(k)} - x^{*}$, si ha
        \begin{equation*}
            e^{(k+1)} = B_{GS} e^{(k)} \quad \Rightarrow \quad e^{(k)} = B_{GS}^k e^{(0)}
        \end{equation*}
        Se $\|B_{GS}\| < 1$, allora:
        \begin{equation*}
            \|e^{(k)}\| \le \|B_{GS}\|^k \|e^{(0)}\| \to 0,
        \end{equation*}
        Per $k \to \infty$. Quindi $x^{(k)} \to x^\ast$: il metodo converge.
    \end{proof}


    \item Verificare se la matrice $A$ soddisfa le condizioni precedenti riportate. Motivare le risposte e riportare i comandi utilizzati.

    \textcolor{Green3}{\textbf{\emph{Soluzione.}}}
    \begin{lstlisting}[language=MATLAB]
first_cond = false;
for row = 1:n
    first_cond = abs(A(row, row)) > (abs(sum(A(row, 1:n))) - abs(A(row, row)));
    if first_cond == 0
        disp("La matrice NON e' a dominanza diagonale stretta per righe")
        break
    end
end

if first_cond
    disp("La matrice e' a dominanza diagonale stretta per righe")
end

% dimostrare che e' simmetrica e definita positiva
second_cond = issymmetric(A) && all(eig(A) > 0);
if second_cond
    disp("La matrice e' simmetrica definita positiva")
else
    disp("La matrice NON e' simmetrica definita positiva")
end

% dimostrare che e' una M-Matrice non singolare
% 1. Extradiagonali non positivi
n = size(A, 1);
% creiamo la matrice con solo la diagonale principale
% diag(diag(A)) e sottraiamo alla matrice A la diagonale
% principale per ottenere la matrice con solo le
% extradiagonali
offdiag = A - diag(diag(A));
% verifichiamo che tutte le extradiagonali siano <= 0
first_m_cond = all(offdiag(:) <= 0);
if first_m_cond == false
    disp("La matrice NON e' una M-matrice: extradiagonali positive")
end
% 2. Diagonale principale positiva
second_m_cond = all(diag(A) > 0);
if second_m_cond == false
    disp("La matrice NON e' una M-matrice: diagonale principale non positiva")
end
% 3. A e' non singolare, cioe' rango(A) = n
% si ricorda che una matrice e' singolare se det(A) = 0
% e che rango(A) = n se e solo se det(A) != 0
% perche' il determinante e' il prodotto degli autovalori
% e una matrice e' singolare se ha almeno un autovalore nullo
third_m_cond = (rank(A) == n);
if third_m_cond == false
    disp("La matrice NON e' una M-matrice: matrice singolare")
end

if first_m_cond && second_m_cond && third_m_cond
    disp("La matrice e' una M-matrice non singolare")
end\end{lstlisting}
    Come risultato finale, si ottiene che la matrice \texttt{A} rispetta le 3 condizioni sufficienti per convergere usando il metodo di Gauss-Seidel.
\end{enumerate}